# Processing and Saving Results

```bash filename="processing_saving.m" copy
clear all; clc;

% Simulate acquired signal from ADC (10-bit resolution, 0–3.3V)
fs = 8000;
duration = 5;
t = 0:1/fs:duration-1/fs;

% Realistic signal: 440 Hz tone (music), environmental noise
tone = sin(2*pi*440*t);
noise = 0.3*randn(size(t));
x = tone + noise;

% ADC quantization (10-bit: values 0–1023, mapped to 0–3.3V)
adc_resolution = 10;
v_ref = 3.3;
adc_max = 2^adc_resolution - 1;
adc_counts = round((x + 1)/2 * adc_max);  % Map [-1, 1] to [0, 1023]
adc_voltage = adc_counts / adc_max * v_ref;  % Back to voltage

% DSP processing
[b, a] = butter(4, 100/(fs/2), 'low');
x_filtered = filtfilt(b, a, adc_voltage);

% Compute statistics
rms_value = rms(x_filtered);  % RMS (root-mean-square)
peak_value = max(abs(x_filtered));
[pxx, freq] = periodogram(x_filtered, [], [], fs);

disp('=== Processing Summary ===');
disp(['RMS Voltage: ', num2str(rms_value, 3), ' V']);
disp(['Peak Voltage: ', num2str(peak_value, 3), ' V']);
disp(['SNR (rough estimate): ', num2str(rms_value/0.3, 2), ' (tone vs noise)']);

% Save results
results = struct();
results.fs = fs;
results.time = t;
results.raw_voltage = adc_voltage;
results.filtered_voltage = x_filtered;
results.rms = rms_value;
results.peak = peak_value;

save('dsp_results.mat', 'results');
disp('Results saved to dsp_results.mat');

% Export to CSV for external analysis
output_table = table(t', adc_voltage', x_filtered', ...
    'VariableNames', {'Time_s', 'ADC_Voltage_V', 'Filtered_Voltage_V'});
writetable(output_table, 'dsp_results.csv');
disp('Results exported to dsp_results.csv');

% Cleanup
delete('dsp_results.mat');
delete('dsp_results.csv');
```

**Explanation**: This workflow simulates ADC data (quantized to 10-bit), processes it, and saves results. `rms` computes root-mean-square (energy metric). `periodogram` analyzes spectral content. Results are saved as MATLAB struct for fast reload or CSV for sharing with other tools. This mirrors real instrument pipelines: ADC → filter → analysis → save.