# Filtering Time-Domain Signals

Apply filters to real signals (not just frequency responses).

```bash filename="filtering_signals.m" copy
clear all; clc;

% Signal with low and high frequency components
fs = 1000;
t = 0:1/fs:2;
low_freq = sin(2*pi*20*t);
high_freq = sin(2*pi*200*t);
x = low_freq + high_freq + 0.2*randn(size(t));

% Design low-pass filter
[b, a] = butter(4, 100/(fs/2), 'low');  % 4th order, 100 Hz cutoff

% Apply filter (forward pass)
y_filtered = filter(b, a, x);

% Zero-phase filtering (remove phase distortion)
y_zero_phase = filtfilt(b, a, x);

figure('Position', [100, 100, 1200, 600]);

% Original signal
subplot(3, 1, 1);
plot(t, x, 'b-', 'LineWidth', 0.5);
xlabel('Time (s)');
ylabel('Amplitude');
title('Original: 20 Hz + 200 Hz + Noise');
grid on;
xlim([0, 0.5]);

% Forward filter only
subplot(3, 1, 2);
plot(t, y_filtered, 'r-', 'LineWidth', 1);
xlabel('Time (s)');
ylabel('Amplitude');
title('Butterworth Filter (forward only)');
grid on;
xlim([0, 0.5]);

% Zero-phase filter (filtfilt)
subplot(3, 1, 3);
plot(t, y_zero_phase, 'g-', 'LineWidth', 1);
xlabel('Time (s)');
ylabel('Amplitude');
title('Zero-Phase Filter (filtfilt: forward-backward)');
grid on;
xlim([0, 0.5]);

% Frequency domain comparison
figure;
X_orig = fft(x);
Y_filtered = fft(y_filtered);
Y_zero = fft(y_zero_phase);
freq = (0:length(t)-1)*fs/length(t);

plot(freq(1:length(freq)/2), abs(X_orig(1:length(X_orig)/2)), 'b-', 'LineWidth', 1, 'DisplayName', 'Original');
hold on;
plot(freq(1:length(freq)/2), abs(Y_filtered(1:length(Y_filtered)/2)), 'r-', 'LineWidth', 1, 'DisplayName', 'Filtered');
plot(freq(1:length(freq)/2), abs(Y_zero(1:length(Y_zero)/2)), 'g-', 'LineWidth', 1, 'DisplayName', 'Zero-phase');
hold off;
xlabel('Frequency (Hz)');
ylabel('Magnitude');
title('Frequency Domain: Effects of Filtering');
legend;
grid on;
xlim([0, 400]);
```

**Explanation**: `filter(b, a, x)` applies the IIR filter causally (output depends only on past/current inputs). `filtfilt` applies the filter twice—forward and backward—canceling phase distortion but losing causality. Choose `filter` for real-time systems, `filtfilt` for offline analysis. The high-frequency component (`200 Hz`) is attenuated, while `20 Hz` passes through.
